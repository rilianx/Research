## Agentes para juegos

- [Boulder Dash](https://www.boulder-dash.com/boulder-dash-online-game/)

### TODO

- Ejemplos de imágenes -> vector de posiciones
- Mostra con puntos los objetos detectados 


### Idea: Simulador automático para entrenar agentes

[track de trayectoria](https://github.com/deepankarkotnala/Object-trajectory-tracking-OpenCV)

- Recompensa es **sparse**. Augmentation of trajectories.

![GeneralFramework](https://i.imgur.com/byclaVc.png)

![GeneralFramework](https://i.imgur.com/YVsLgZf.png)

![TrainedSimulator](https://i.imgur.com/LLd7NTS.png)

**Versión 2.0**

![simulador2.0](https://i.imgur.com/N9IUB0m.png)


**Versión 3.0**

**Simulator (S)**: Red que a partir de estado+acción, predice estado siguiente+reward
**Critic (V)**: Red que predice retorno/value a partir de una observación
**Actor (A)**: Red que predice retornos (advantage values) para cada acción

Algoritmo de entrenamiento:

1. Recopila trayectorias (s_t,action,reward) corriendo la política (actor) en el ambiente.
2. Calcula los rewards-to-go ($R_t$) para cada estado t
3. $s_t \rightarrow R_{t}$ se usa para ajustar el crítico (predictor de valores)
![image](https://i.imgur.com/BZdScFy.png)
5. $(s_t, a_t) \rightarrow s_{t+1},r_{t+1}$ se usa para entrenar el simulador.
6. Para ajustar al actor se calculan los valores de ventaja (advantage values). Para un estado s y una acción a, el valor de ventaja se obtiene:
$A(s,a)  = Q(s,a) - V(s)$, es decir cuánto mejoró el estado el hecho de aplicar la acción.
También lo podemos denotar: $A(s,a)=r+\gamma V(s_{​+1} )−V(s)$.
$r+\gamma V(s_{​+1})$ se conoce como TD (temporal difference) target y es una estimación del $Q(s,a)$.
Ayudados del simulador S, podemos calcular $V(s_{+1})$ para las acciones que **no fueron realizadas**. $s_{+1}(s,a) =S(s,a)$.
El actor se entrena usando $s \rightarrow A(s,a_i)$.
7. Además, una vez bien entrenado el simulador, se puede comenzar a usar en lugar del ambiente para aumentar trayectorias sin tener que jugar y *gastar dinero en fichas*.
 
<!--stackedit_data:
eyJoaXN0b3J5IjpbMTY3MzgyNDA4NywxODQ4NTk5MzU1LDE2MT
A3OTI4MTAsLTEwNDAxMjQ5NDMsMTAyOTE3NjczOSwtMzg2ODI2
NTE4LDEwMDExMTY5NTUsLTUzMzE1OTkxMCwxMDE3NDUyMzEsLT
E0MjI0NjYxMjAsMTI4NDcyMjg2NiwtODMxNTc0MTIyLC00NDg2
ODgyOTAsMjA3MDY2ODUxMSwtNzA1NDYzODMsMTY2NjE0OTQ4OV
19
-->